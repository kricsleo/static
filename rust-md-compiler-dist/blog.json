{"path":"blog","title":"","summary":"Nginx 服务静态资源转发-》cdn-》oss接口服务-》koa-》es/mysql全文检索服务es: es占用的内存太大了, 目前考虑弃用转向其他的更轻量的全文检索方式Mysql + ngramn","text":"Nginx 服务静态资源转发-》cdn-》oss接口服务-》koa-》es/mysql全文检索服务es: es占用的内存太大了, 目前考虑弃用转向其他的更轻量的全文检索方式Mysql + ngramnode服务暂时想使用koa，一个原因是暂时没有那么复杂的需求，另一个原因koa相对来说比较轻量和点型，在使用的过程中能够逐渐学习，举一反三但是我可能还会做seo相关的内容，那么koa就太过于简单，不如一些集成了服务端渲染的框架例如nextjs或者nuxtjs先上koa！！摸通了koa以后再逐步考虑seo的问题oss 服务原始域名：kricsleo.oss-cn-hangzhou.aliyuncs.com绑定域名：oss.kricsleo.comcdn 服务CNAME：oss.kricsleo.com.w.kunlunaq.com源站：oss.kricsleo.com基于hooks的自动部署更新服务本地开发push代码使用git hooks 推送push事件到blog-server使用blog-server /deploy api接收push事件使用shell git 判断package.json 和 yarn.lock是否变更，如果变更后续需要执行yarn重新安装依赖，否则不重新安装依赖~~使用shell git 判断app.json是否更新，如果变更后续需要使用pm2 restart服务，否则使用pm2 reload服~~改为使用cluster集群模式, 可以直接启动ts, 免编译使用shell git 拉取最新代码到本地[根据之前的依赖变更判断是否执行yarn重新安装依赖]根据之前的app.json变更判断使用pm2 restart服务还是pm2 reload服务 改为使用cluster逐个停止旧进程并开启新进程, 服务也可以达到平滑重启的目的","html":"<h1></h1>\n<ul>\n<li><input disabled=\"\" type=\"checkbox\" checked=\"\"/>\n<p>Nginx 服务</p>\n<ul>\n<li><input disabled=\"\" type=\"checkbox\" checked=\"\"/>\n<p>静态资源转发-》cdn-》oss</p>\n</li>\n<li><input disabled=\"\" type=\"checkbox\" checked=\"\"/>\n<p>接口服务-》koa-》es/mysql</p>\n</li>\n</ul>\n</li>\n<li><input disabled=\"\" type=\"checkbox\"/>\n<p>全文检索服务</p>\n<ul>\n<li><input disabled=\"\" type=\"checkbox\" checked=\"\"/>\n<del>es</del>: es占用的内存太大了, 目前考虑弃用转向其他的更轻量的全文检索方式</li>\n<li><input disabled=\"\" type=\"checkbox\"/>\nMysql + ngram</li>\n</ul>\n</li>\n<li><input disabled=\"\" type=\"checkbox\" checked=\"\"/>\n<p>node服务</p>\n<p>暂时想使用koa，一个原因是暂时没有那么复杂的需求，另一个原因koa相对来说比较轻量和点型，在使用的过程中能够逐渐学习，举一反三</p>\n<p>但是我可能还会做seo相关的内容，那么koa就太过于简单，不如一些集成了服务端渲染的框架例如nextjs或者nuxtjs</p>\n<p>先上koa！！摸通了koa以后再逐步考虑seo的问题</p>\n</li>\n<li><input disabled=\"\" type=\"checkbox\" checked=\"\"/>\n<p>oss 服务</p>\n<ul>\n<li><input disabled=\"\" type=\"checkbox\" checked=\"\"/>\n原始域名：kricsleo.oss-cn-hangzhou.aliyuncs.com</li>\n<li><input disabled=\"\" type=\"checkbox\" checked=\"\"/>\n绑定域名：oss.kricsleo.com</li>\n</ul>\n</li>\n<li><input disabled=\"\" type=\"checkbox\" checked=\"\"/>\n<p>cdn 服务</p>\n<ul>\n<li><input disabled=\"\" type=\"checkbox\" checked=\"\"/>\nCNAME：oss.kricsleo.com.w.kunlunaq.com</li>\n<li><input disabled=\"\" type=\"checkbox\" checked=\"\"/>\n源站：oss.kricsleo.com</li>\n</ul>\n</li>\n<li><input disabled=\"\" type=\"checkbox\" checked=\"\"/>\n<p>基于hooks的自动部署更新服务</p>\n<ul>\n<li><input disabled=\"\" type=\"checkbox\" checked=\"\"/>\n本地开发push代码</li>\n<li><input disabled=\"\" type=\"checkbox\" checked=\"\"/>\n使用git hooks 推送push事件到blog-server</li>\n<li><input disabled=\"\" type=\"checkbox\" checked=\"\"/>\n使用blog-server /deploy api接收push事件</li>\n<li><input disabled=\"\" type=\"checkbox\" checked=\"\"/>\n使用shell git 判断package.json 和 yarn.lock是否变更，如果变更后续需要执行yarn重新安装依赖，否则不重新安装依赖</li>\n<li><input disabled=\"\" type=\"checkbox\" checked=\"\"/>\n~~使用shell git 判断app.json是否更新，如果变更后续需要使用pm2 restart服务，否则使用pm2 reload服~~改为使用cluster集群模式, 可以直接启动ts, 免编译</li>\n<li><input disabled=\"\" type=\"checkbox\" checked=\"\"/>\n使用shell git 拉取最新代码到本地</li>\n<li><input disabled=\"\" type=\"checkbox\" checked=\"\"/>\n[根据之前的依赖变更判断是否执行yarn重新安装依赖]</li>\n<li><input disabled=\"\" type=\"checkbox\" checked=\"\"/>\n<del>根据之前的app.json变更判断使用pm2 restart服务还是pm2 reload服务</del> 改为使用cluster逐个停止旧进程并开启新进程, 服务也可以达到平滑重启的目的</li>\n</ul>\n</li>\n</ul>\n<video id=\"video\" controls=\"\" preload=\"none\" poster=\"封面\">\n      <source id=\"mp4\" src=\"https://vdn1.vzuu.com/SD/d6014312-2336-11eb-87b9-bae1634971f0.mp4?disable_local_cache=1&auth_key=1624502343-0-0-0586bd5ebd880a697362f5a0705c5516&f=mp4&bu=pico&expiration=1624502343&v=hw\" type=\"video/mp4\">\n</videos>","c_time":"2021-11-18 03:05:44","m_time":"2021-11-18 03:05:44"}