;;;;const request={_controllerCache:new Map(),get(url,params,options){const query=params?`?${Object.entries(params).map(t=>t.join('=')).join('&')}`:'';return request.fetch(`${url}${query}`,options)},post(url,data,options){return request.fetch(url,{method:'POST',body:JSON.stringify(data),...options})},async fetch(url,options={}){let{signal:optSignal,...restOpts}=options;let fetchSignal;const{_controllerCache}=request;if(optSignal instanceof AbortSignal){fetchSignal=optSignal}else if(optSignal){const controller=_controllerCache.get(optSignal)||new AbortController();_controllerCache.set(optSignal,controller);fetchSignal=controller.signal}try{const response=await fetch(url,{signal:fetchSignal,...restOpts});const result=await response.json();if(result?.c!==0){throw new Error(result)}return result.d}catch(e){throw new Error(e)}},abort(signal){const{_controllerCache}=request;const controller=_controllerCache.get(signal);if(controller){controller.abort();_controllerCache.delete(signal)}}};const dom={on(parent,selector,eventName,callback,options){if(typeof selector==='string'){const root=typeof parent==='string'?dom.node(parent):parent;root.addEventListener(eventName,e=>{let el=e.target;while(el&&!el.matches(selector)&&el!==root){el=el.parentElement}el&&callback(e,el)},options)}else{selector.addEventListener(eventName,e=>callback(e,selector),options)}},dispatchEvent(selector,eventName){const event=new Event(eventName);dom.node(selector).dispatchEvent(event)},render(selector,html){dom.nodes(selector).forEach(node=>node.innerHTML=html)},nodes(selector){return Array.from(document.querySelectorAll(selector))},node(selector){return document.querySelector(selector)},createNode(tag,props,children){if(!props&&!children){return document.createTextNode(tag)}const node=document.createElement(tag);props&&Object.entries(props).forEach(([key,value])=>{switch(key){case'style':dom.styleNode(node,value);break;case'dataset':Object.entries(value).forEach(([dKey,dValue])=>node.dataset[dKey]=dValue);break;default:node.setAttribute(key,value);break}});if(typeof children==='string'){node.innerHTML=children}else if(Array.isArray(children)){children.forEach(child=>node.appendChild(child))}else if(dom.isNode(children)){node.appendChild(children)}return node},styleNode(node,style){Object.entries(style).forEach(([key,value])=>node.style[key]=value);return node},isNode(node){return node?.nodeType===1}};const VARS={sidebarResult:'sidebar__input-result',sidebarResultItemClass:'sidebar__input-item',articleWrapperClass:'article__wrapper',articleViewportClass:'article__viewport',articleContentClass:'article__content'};const router={listenState(){let currentTimestamp=Date.now();window.addEventListener('popstate',e=>{const{state:{html,timestamp}={}}=e;const isBack=timestamp<currentTimestamp;currentTimestamp=timestamp;const{articleViewportClass,articleContentClass,articleWrapperClass}=VARS;const wrapperNode=dom.node(`.${articleWrapperClass}`);const viewportNode=dom.node(`.${articleViewportClass}`);const prevContentNodes=dom.nodes(`.${articleContentClass}`);const contentNode=dom.createNode('div',{class:articleContentClass},html);viewportNode.appendChild(contentNode);wrapperNode.scrollTop=0;prevContentNodes.forEach(t=>{dom.styleNode(t,{position:'absolute',transformOrigin:isBack?'bottom right':'top left',transition:'all 300ms ease-in-out',transform:'scale(0)',opacity:'0'});dom.on(t,t,'transitionend',()=>t.remove())})})},push(url,data=null){history.pushState(data,undefined,url)},replace(url,data=null){history.replaceState(data,undefined,url)}};function throttle(fn,interval=200,options={}){const{trailing}=options;let last;let trailingTimer;return function(...args){const now=Date.now();const call=()=>{last=now;fn(...args)};const passed=last?now-last:interval;if(passed<interval){if(trailing){clearTimeout(trailingTimer);trailingTimer=setTimeout(call,interval-passed)}return}call()}}function initInputSearch(){const inputSelector='#sidebar__input';const resultSelector='#sidebar__input-result';const renderResult=(list,value)=>{const resultNode=dom.node(resultSelector);if(!list.length){resultNode.innerHTML='No content here :-)';return}const resultFrag=document.createDocumentFragment();list.forEach(({title,path,text,html})=>{const url=`${path}.html`;const matchedContent=text.replace(new RegExp(value),'<strong class="font-red">$&</strong>');const liNode=dom.createNode('li',{class:VARS.sidebarResultItemClass},`
        <a href="${url}">
          ${title?`<h5 class="ellipsis">${title}</h5>`:''}
          <p class="ellipsis-2">${matchedContent}</p>
        </a>
      `);liNode.blogHtml=html;liNode.blogPath=url;resultFrag.appendChild(liNode)});resultNode.innerHTML='';resultNode.appendChild(resultFrag)};const signal=Symbol('inputSearch');const throttledSearch=throttle(async e=>{const keyword=e.target.value;request.abort(signal);try{const result=await request.get('https://api.kricsleo.com/query',{page:1,size:10,keyword},{signal});renderResult(result.list,keyword)}catch(e1){}},300,{trailing:true});dom.on(inputSelector,inputSelector,'input',e=>!e.target.isComposing&&throttledSearch(e));dom.on(inputSelector,inputSelector,'compositionstart',e=>e.target.isComposing=true);const triggerInput=()=>dom.dispatchEvent(inputSelector,'input');dom.on(inputSelector,inputSelector,'compositionend',e=>{e.target.isComposing=false;triggerInput()});triggerInput()}function initLinkAnimation(){dom.on(`.${VARS.sidebarResult}`,`.${VARS.sidebarResultItemClass}`,'click',(e,el)=>{e.preventDefault();const{blogPath:path,blogHtml:html}=el;const wrapperNode=dom.node(`.${VARS.articleWrapperClass}`);const viewportNode=dom.node(`.${VARS.articleViewportClass}`);const{top:archorTop}=wrapperNode.getBoundingClientRect();const{top:prevTop,left:prevLeft,width:prevWidth,height:prevHeight}=el.getBoundingClientRect();const contentNode=dom.createNode('div',{class:VARS.articleContentClass,style:{position:'absolute',top:'0'}},html);viewportNode.appendChild(contentNode);const{left,width,height}=contentNode.getBoundingClientRect();const deltW=prevWidth/width;const deltH=prevHeight/height;const deltX=prevLeft-left;const deltY=prevTop-archorTop;dom.styleNode(contentNode,{position:'fixed',...Object.entries({top:archorTop,left,width,height}).reduce((all,[k,v])=>{all[k]=`${v}px`;return all},{}),transformOrigin:'left top',transform:`translate(${deltX}px, ${deltY}px) scale(${deltW}, ${deltH})`,opacity:'0.5',background:'#fff'});requestAnimationFrame(()=>dom.styleNode(contentNode,{transition:'all 300ms ease-in-out',transform:'',opacity:'',background:''}));dom.on(contentNode,contentNode,'transitionend',()=>{dom.node(`.${VARS.articleContentClass}`).remove();dom.styleNode(contentNode,{position:'',top:'',left:'',width:'',height:'',transformOrigin:'',transition:''});router.push(path,{html,timestamp:Date.now()})},{once:true})})}function init(){window.addEventListener('load',()=>{router.listenState();initInputSearch();initLinkAnimation()})}init()